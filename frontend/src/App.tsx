import React, { useState, useEffect } from 'react';
import { BrowserRouter as Router, Route } from 'react-router-dom';
import LandingPage from './components/LandingPage';
import SearchPage from './components/SearchPage';
import ExploitPage from './components/ExploitPage';
import { createMuiTheme, CssBaseline } from '@material-ui/core';
import { ThemeProvider } from '@material-ui/styles';
import Header from './components/Header';
import EditorPage from './components/EditorPage';
import LoginPage from './components/LoginPage';
import LogoutPage from './components/LogoutPage';
import AccountCreatedPage from './components/AccountCreatedPage';
import SQLInjectionPage from './components/SandboxPages/SQLInjection';

const lightTheme = createMuiTheme({
    typography: {
        fontFamily: 'Montserrat'
    },
    palette: {
        primary: {
            main: '#ffffff'
        }
    }
})

const darkTheme = createMuiTheme({
    typography: {
        fontFamily: 'Montserrat'
    },
    palette: {
        type: 'dark',
    }
})

const App: React.FC = () => {

    const [isDark, setDark] = useState(false);

    useEffect(() => {
        const theme = localStorage.getItem('theme');

        if(theme === 'dark'){
            setDark(true);
        } else {
            setDark(false);
        }
    }, [])

    return (
        <ThemeProvider theme={(isDark) ? darkTheme : lightTheme}>
                <CssBaseline />
                <Router>
                    <Header changeTheme={() => {
                        if(isDark === true){
                            localStorage.setItem('theme', 'light');
                        } else {
                            localStorage.setItem('theme', 'dark');
                        }
                        setDark(!isDark);
                    }} />
                    <Route path="/" exact component={LandingPage} />
                    <Route path="/search" component={SearchPage} />
                    <Route path="/exploit/:id" component={ExploitPage} />
                    <Route path="/editor" exact component={EditorPage} />
                    <Route path="/editor/:id" component={EditorPage} />
                    <Route path="/login" component={LoginPage} />
                    <Route path="/logout" component={LogoutPage} />
                    <Route path="/sandbox/sql-injection" exact component={SQLInjectionPage} />
                    <Route path="/account-created" exact component={AccountCreatedPage} />
                </Router>
        </ThemeProvider>
    );
}

export default App;